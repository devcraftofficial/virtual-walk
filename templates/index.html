<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ABTO - A Better Travel Observer</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="ABTO - A Better Travel Observer. Explore real streets worldwide with immersive walk, drive, and fly modes.">

<!-- Fonts & Icons -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

<style>
/* ================= ROOT THEME ================= */
:root {
  --bg-main:#0a0b15;
  --bg-soft:#0f1223;
  --glass:rgba(255,255,255,.04);
  --glass-hover:rgba(255,255,255,.08);
  --accent:#5d5eff;
  --accent2:#7c3aed;
  --accent3:#ec4899;
  --gradient:linear-gradient(135deg,#5d5eff,#7c3aed,#a855f7);
  --gradient-glow:linear-gradient(135deg,#5d5eff22,#7c3aed22,#a855f722);
  --text:#f8fafc;
  --text-muted:#94a3b8;
  --text-dim:#64748b;
  --border:rgba(255,255,255,.08);
  --border-accent:rgba(93,94,255,.2);
  --radius-xl:24px;
  --radius-lg:18px;
  --radius:12px;
  --shadow:0 25px 50px rgba(0,0,0,.45);
  --shadow-glow:0 0 0 1px rgba(93,94,255,.2), 0 25px 50px rgba(0,0,0,.45);
  --nav-h:86px;
  --nav-h-mobile:70px;
  --hero-badge-top:120px;
  --hero-badge-top-mobile:80px;
  --ease:all .35s cubic-bezier(.4,0,.2,1);
  --ease-fast:all .2s cubic-bezier(.4,0,.2,1);
}

/* ================= BASE ================= */
*, *::before, *::after {box-sizing:border-box}
html {scroll-behavior:smooth}
body {
  font-family:'Inter',system-ui,sans-serif;
  background: 
    radial-gradient(circle at 20% 20%,rgba(93,94,255,.12),transparent 50%),
    radial-gradient(circle at 80% 80%,rgba(124,58,237,.1),transparent 50%),
    linear-gradient(135deg,#0a0b15,#0f1223);
  color:var(--text);
  line-height:1.6;
  padding-top:var(--nav-h);
  overflow-x:hidden;
  position:relative;
}

/* ================= ANIMATIONS ================= */
@keyframes fadeInUp {
  from {opacity:0; transform:translateY(30px)}
  to {opacity:1; transform:translateY(0)}
}
@keyframes float {
  0%,100%{transform:translateY(0)}
  50%{transform:translateY(-8px)}
}
@keyframes pulse-glow {
  0%,100%{box-shadow:var(--shadow)}
  50%{box-shadow:var(--shadow-glow)}
}
@keyframes spin {
  from {transform:rotate(0deg)}
  to {transform:rotate(360deg)}
}
@keyframes slideDown {
  from {transform: translateY(-100%); opacity: 0;}
  to {transform: translateY(0); opacity: 1;}
}
.fade-in-up {animation:fadeInUp .8s ease forwards}

/* ================= NAV ================= */
nav {
  position:fixed;top:0;left:0;right:0;height:var(--nav-h);
  display:flex;align-items:center;justify-content:space-between;
  padding:0 max(16px, 5vw);backdrop-filter:blur(22px);
  background:rgba(10,11,21,.95);border-bottom:1px solid var(--border);
  z-index:999;transition:var(--ease);
}
nav.scrolled {
  background:rgba(10,11,21,.98);box-shadow:0 10px 40px rgba(0,0,0,.5);
}
.logo {
  font-size:clamp(20px, 5vw, 28px);font-weight:900;
  background:var(--gradient);-webkit-background-clip:text;
  -webkit-text-fill-color:transparent;text-decoration:none;
  letter-spacing:-.03em;position:relative;
}
.logo:hover {transform:scale(1.05);}
.logo::after {
  content:'A Better Travel Observer';position:absolute;bottom:-24px;
  left:50%;transform:translateX(-50%);font-size:10px;color:var(--text-muted);
  font-weight:400;white-space:nowrap;opacity:0;transition:var(--ease);
  pointer-events:none;
}
.logo:hover::after {opacity:1;bottom:-28px;}
.nav-links {
  display:flex;gap:12px;align-items:center;flex-wrap:wrap;
}
.nav-links.active {
  display:flex !important;
  position:fixed;top:var(--nav-h);left:0;right:0;
  background:rgba(10,11,21,.98);flex-direction:column;
  padding:32px 20px;backdrop-filter:blur(22px);
  border-top:1px solid var(--border);gap:16px;
  animation:slideDown .3s ease;
}
.nav-link {
  text-decoration:none;color:var(--text);padding:12px 24px;border-radius:999px;
  font-weight:600;border:1px solid transparent;font-size:clamp(14px, 2.5vw, 15px);
  transition:var(--ease);position:relative;overflow:hidden;white-space:nowrap;
  min-width:fit-content;
}
.nav-link::before {
  content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;
  background:linear-gradient(90deg,transparent,rgba(255,255,255,.1),transparent);
  transition:var(--ease-fast);
}
.nav-link:hover::before {left:100%}
.nav-link:hover {
  background:var(--glass-hover);border-color:var(--border);transform:translateY(-2px);
}
.nav-link.primary {
  background:var(--gradient);box-shadow:0 15px 40px rgba(93,94,255,.45);
  color:#fff !important;
}
.nav-link.primary:hover {
  transform:translateY(-3px) scale(1.02);box-shadow:0 20px 50px rgba(93,94,255,.6);
}
.mobile-menu-toggle {
  display:none;flex-direction:column;gap:5px;cursor:pointer;padding:8px;
}
.hamburger {
  width:24px;height:2px;background:var(--text);transition:var(--ease-fast);
  border-radius:2px;
}

/* ================= HERO - ENHANCED BUZZSUMO STYLE ================= */
.hero {
  min-height:calc(100vh - var(--nav-h));display:grid;
  grid-template-columns:1fr 520px;grid-template-rows:auto 1fr auto;
  gap:60px 80px;align-items:center;padding:var(--hero-badge-top) max(40px, 6vw) 80px;
  position:relative;max-width:1600px;margin:0 auto;
}
.hero::before {
  content:'';position:absolute;top:0;left:0;right:0;bottom:0;
  background:radial-gradient(circle at 15% 20%,rgba(93,94,255,.08),transparent 50%),
              radial-gradient(circle at 85% 80%,rgba(124,58,237,.06),transparent 50%);
  pointer-events:none;z-index:1;
}
.hero-content {
  display:flex;flex-direction:column;justify-content:center;gap:40px;
  position:relative;z-index:2;grid-column:1;grid-row:1 / 4;padding-right:60px;
}
.hero-badge {
  display:inline-flex;gap:12px;align-items:center;padding:14px 28px;
  background:var(--glass);border:1px solid var(--border-accent);border-radius:999px;
  backdrop-filter:blur(20px);animation:float 6s ease-in-out infinite;max-width:max-content;
}
.hero-badge i {color:var(--accent);font-size:20px}
.hero h1 {
  font-size:clamp(48px, 10vw, 84px);font-weight:800;line-height:1.05;
  background:linear-gradient(135deg,#fff 0%,var(--accent) 50%,#ec4899 100%);
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;margin:0;
  letter-spacing:-.03em;
}
.hero h1::after {
  content:'ABTO';display:block;font-size:clamp(20px, 4vw, 28px);font-weight:700;
  color:var(--accent);margin-top:12px;opacity:.9;
}
.hero p {
  max-width:560px;font-size:clamp(18px, 2.5vw, 22px);color:#e5e7eb;
  font-weight:400;line-height:1.7;margin:0;
}
.hero p::before {
  content:'A Better Travel Observer brings you ';font-weight:600;color:var(--accent);
}
.hero-cta {
  display:inline-flex;gap:12px;align-items:center;padding:20px 44px;
  background:var(--gradient);color:#fff;text-decoration:none;font-weight:700;
  border-radius:999px;box-shadow:0 25px 55px rgba(93,94,255,.5);transition:var(--ease);
  font-size:clamp(16px, 2.5vw, 18px);max-width:max-content;position:relative;overflow:hidden;
}
.hero-cta::before {
  content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;
  background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);
  transition:var(--ease-fast);
}
.hero-cta:hover::before {left:100%}
.hero-cta:hover {
  transform:translateY(-6px) scale(1.02);box-shadow:0 35px 65px rgba(93,94,255,.65);
}

/* ================= PERFECTED 3 SCREENSHOT LAYOUT ================= */
.hero-visual {
  grid-column:2;grid-row:1 / 4;position:relative;z-index:2;display:flex;
  flex-direction:column;justify-content:center;align-items:flex-end;gap:20px;
  height:100%;
}
.hero-screenshots {
  display:flex;gap:20px;align-items:flex-start;position:relative;width:100%;
  margin-top:20px;
}
.hero-screenshot-main {
  width:300px;height:400px;flex-shrink:0;background:var(--glass);border-radius:var(--radius-xl);
  backdrop-filter:blur(20px);border:1px solid var(--border-accent);box-shadow:var(--shadow-glow);
  position:relative;overflow:hidden;background-image:linear-gradient(135deg, var(--gradient-glow), transparent);
  z-index:2;
}
.hero-screenshot-main img {
  width:100%;height:100%;object-fit:cover;border-radius:18px;
}
.hero-screenshot-small-top {
  width:200px;height:280px;background:var(--glass);border-radius:var(--radius-lg);
  backdrop-filter:blur(16px);border:1px solid var(--border-accent);box-shadow:var(--shadow-glow);
  position:absolute;top:-20px;right:-10px;overflow:hidden;background-image:linear-gradient(135deg, var(--gradient-glow), transparent);
  z-index:4;flex-shrink:0;
}
.hero-screenshot-small-top img {
  width:100%;height:100%;object-fit:cover;border-radius:12px;
}
.hero-screenshot-small-right {
  width:220px;height:200px;background:var(--glass);border-radius:var(--radius-lg);
  backdrop-filter:blur(16px);border:1px solid var(--border-accent);box-shadow:var(--shadow-glow);
  position:absolute;bottom:-30px;right:-20px;overflow:hidden;background-image:linear-gradient(135deg, var(--gradient-glow), transparent);
  z-index:3;
}
.hero-screenshot-small-right img {
  width:100%;height:100%;object-fit:cover;border-radius:12px;
}
.hero-visual-title {
  align-self:flex-end;color:var(--text);font-size:clamp(18px, 2.5vw, 24px);
  font-weight:700;margin:0 0 20px auto;text-align:right;
}
.hero-visual-info {
  align-self:flex-end;color:var(--text-muted);font-size:14px;text-align:right;
  max-width:300px;
}
.hero-visual-info strong {color:var(--text);font-weight:600;}

/* ================= MODES ================= */
.modes {
  display:grid;grid-template-columns:repeat(auto-fit, minmax(280px, 1fr));
  gap:32px;max-width:1200px;margin:120px auto 0;padding:0 24px;
}
.mode-card {
  background:var(--glass);border:1px solid var(--border);border-radius:var(--radius-xl);
  padding:clamp(36px, 8vw, 48px) clamp(28px, 5vw, 36px);text-align:center;transition:var(--ease);
  text-decoration:none;color:inherit;backdrop-filter:blur(12px);position:relative;overflow:hidden;
}
.mode-card::before {
  content:'ABTO';position:absolute;top:16px;right:16px;font-size:12px;color:var(--accent);
  font-weight:700;background:var(--glass);padding:6px 10px;border-radius:16px;
  border:1px solid var(--border-accent);opacity:.9;transition:var(--ease);
}
.mode-card::after {
  content:'';position:absolute;top:0;left:0;right:0;height:4px;background:var(--gradient);
  transform:scaleX(0);transition:var(--ease);
}
.mode-card:hover::after {transform:scaleX(1)}
.mode-card:hover {
  transform:translateY(-14px);box-shadow:var(--shadow-glow);border-color:var(--accent);
}
.mode-icon {
  font-size:clamp(48px, 12vw, 56px);margin-bottom:20px;display:block;
  filter:drop-shadow(0 10px 25px rgba(93,94,255,.4));animation:float 4s ease-in-out infinite;
}
.mode-card h3 {
  margin:0 0 16px;font-size:clamp(22px, 4vw, 26px);font-weight:700;
}
.mode-card h3::after {
  content:' - ABTO';font-size:.65em;opacity:.8;
}
.mode-card p {
  margin:0;color:var(--text-muted);font-weight:400;font-size:clamp(15px, 2.5vw, 17px);
}

/* ================= SECTIONS ================= */
.section {
  padding:clamp(100px, 15vw, 160px) max(32px, 6vw);max-width:1600px;margin:auto;
}
.section h2 {
  text-align:center;font-size:clamp(36px, 7vw, 52px);font-weight:800;margin-bottom:20px;
  background:var(--gradient);-webkit-background-clip:text;-webkit-text-fill-color:transparent;
}
.section h2::after {
  content:'ABTO';display:block;font-size:clamp(18px, 3vw, 24px);font-weight:700;
  color:var(--accent);opacity:.9;margin-top:8px;
}
.section p {
  text-align:center;color:var(--text-muted);font-size:clamp(16px, 2.5vw, 20px);
  margin-bottom:80px;max-width:900px;margin-left:auto;margin-right:auto;
}
.grid {
  display:grid;grid-template-columns:repeat(auto-fit, minmax(280px, 1fr));
  gap:clamp(24px, 4vw, 32px);
}
.card {
  background:var(--glass);border:1px solid var(--border);border-radius:var(--radius-xl);
  overflow:hidden;transition:var(--ease);text-decoration:none;color:inherit;
  backdrop-filter:blur(12px);position:relative;min-height:340px;display:flex;flex-direction:column;
}
.card::before {
  content:'ABTO';position:absolute;top:16px;right:16px;font-size:11px;color:#fff;
  font-weight:700;background:var(--accent);padding:6px 10px;border-radius:16px;opacity:0;
  transition:var(--ease);
}
.card:hover::before {opacity:1}
.card::after {
  content:'';position:absolute;inset:0;background:var(--gradient-glow);opacity:0;transition:var(--ease);
}
.card:hover::after {opacity:1}
.card:hover {
  transform:translateY(-12px);box-shadow:var(--shadow-glow);
}
.thumb {
  height:clamp(180px, 25vw, 220px);background-size:cover;background-position:center;
  position:relative;overflow:hidden;flex-shrink:0;
}
.thumb::after {
  content:'';position:absolute;inset:0;background:linear-gradient(45deg,#5d5eff33,#7c3aed22);
  opacity:0;transition:var(--ease);
}
.card:hover .thumb::after {opacity:1}
.thumb-placeholder {
  display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg, var(--glass), var(--bg-soft));
  color:var(--text-muted);font-size:clamp(52px, 12vw, 68px);
}
.card-body {
  padding:28px;flex-grow:1;display:flex;flex-direction:column;
}
.card-body h4 {
  margin:0 0 12px;font-size:clamp(18px, 3vw, 22px);font-weight:700;line-height:1.3;flex-grow:1;
}
.card-body span {
  color:var(--text-muted);font-size:clamp(14px, 2vw, 15px);font-weight:500;margin-top:auto;
}

/* ================= LOADING & EMPTY STATES ================= */
.loading {
  position:fixed;top:0;left:0;right:0;bottom:0;background:var(--bg-main);
  display:flex;align-items:center;justify-content:center;z-index:10000;
  opacity:1;transition:all .4s ease;transform:scale(1);
}
.loading::before {
  content:'ABTO';color:var(--accent);font-weight:700;font-size:24px;margin-right:16px;
}
.loading i {
  font-size:36px;animation:spin 1s linear infinite;margin-right:20px;
}
.empty-state {
  text-align:center;padding:clamp(100px, 20vw, 140px) 40px;color:var(--text-muted);
}
.empty-state h3::before {
  content:'ABTO';display:block;font-size:clamp(28px, 8vw, 36px);font-weight:800;
  background:var(--gradient);-webkit-background-clip:text;-webkit-text-fill-color:transparent;
  margin-bottom:20px;
}
.empty-state i {
  font-size:clamp(56px, 15vw, 72px);margin-bottom:28px;opacity:.6;
}

/* ================= PERFECT MOBILE RESPONSIVE ================= */
@media(max-width:1400px) {
  .hero {grid-template-columns:1fr 460px;gap:50px 60px;}
  .hero-screenshot-main {width:280px;height:380px;}
  .hero-screenshot-small-top {width:190px;height:260px;}
  .hero-screenshot-small-right {width:210px;height:180px;}
}
@media(max-width:1200px) {
  .hero {grid-template-columns:1fr;padding:var(--hero-badge-top) 40px 60px;}
  .hero-content {padding-right:30px;}
  .hero-visual {grid-column:1;grid-row:4;justify-content:center;align-items:center;}
  :root {--hero-badge-top:100px;}
}
@media(max-width:768px) {
  :root {--nav-h:var(--nav-h-mobile);--hero-badge-top:var(--hero-badge-top-mobile);}
  nav {padding:16px;height:var(--nav-h);}
  body {padding-top:var(--nav-h)}
  .logo {font-size:clamp(20px, 6vw, 26px)}
  .logo::after {font-size:10px;bottom:-22px;}
  .nav-links {display:none;}
  .nav-links.active {
    display:flex !important;
    position:fixed;top:var(--nav-h);left:0;right:0;
    background:rgba(10,11,21,.98);flex-direction:column;
    padding:32px 20px;backdrop-filter:blur(22px);
    border-top:1px solid var(--border);gap:16px;
    animation:slideDown .3s ease;
  }
  .mobile-menu-toggle {display:flex;}
  .hero {
    grid-template-columns:1fr;grid-template-rows:auto auto auto;gap:24px;
    padding:var(--hero-badge-top) 20px 40px;text-align:center;
  }
  .hero-content {grid-column:1;padding-right:0;grid-row:1;}
  .hero-visual {grid-column:1;grid-row:2;align-items:center;justify-content:center;}
  .hero-screenshots {
    flex-direction:column !important;gap:20px !important;align-items:center !important;
    width:100% !important;max-width:100% !important;
  }
  .hero-screenshot-main {
    position:static !important;width:100% !important;max-width:340px !important;
    height:380px !important;top:auto !important;right:auto !important;
  }
  .hero-screenshot-small-top {
    position:static !important;top:auto !important;right:auto !important;
    width:280px !important;height:220px !important;margin:8px auto 0 !important;
  }
  .hero-screenshot-small-right {
    position:static !important;top:auto !important;bottom:auto !important;right:auto !important;
    transform:none !important;width:280px !important;height:180px !important;
    margin:8px auto 20px !important;
  }
  .hero-badge {justify-content:center;margin:0 auto;}
  .hero h1 {font-size:clamp(38px, 10vw, 52px);line-height:1.1;}
  .hero h1::after {font-size:clamp(18px, 5vw, 22px);}
  .hero-visual-title,.hero-visual-info {text-align:center;align-self:center;width:100% !important;}
  .section {padding:80px 20px}
  .grid {grid-template-columns:1fr;gap:28px}
  .modes {margin-top:80px;gap:24px;padding:0 16px;grid-template-columns:1fr;}
}
@media(max-width:480px) {
  :root {--nav-h:66px;}
  nav {padding:12px 16px}
  .hero-cta {flex-direction:column;gap:8px;padding:18px 36px;font-size:16px}
  .hero-screenshot-main {height:300px !important;max-width:320px !important;}
  .hero-screenshot-small-top {width:260px !important;height:200px !important;}
  .hero-screenshot-small-right {width:260px !important;height:160px !important;}
  .mode-card {padding:32px 24px}
  .card-body {padding:24px}
  .hero {gap:20px;padding:60px 16px 30px;}
  .hero-screenshots {gap:16px !important;}
}

/* ================= HAMBURGER ANIMATION ================= */
.mobile-menu-toggle.open .hamburger:nth-child(1) {
  transform: rotate(45deg) translate(6px, 6px);
}
.mobile-menu-toggle.open .hamburger:nth-child(2) {opacity: 0;}
.mobile-menu-toggle.open .hamburger:nth-child(3) {
  transform: rotate(-45deg) translate(6px, -6px);
}
</style>
</head>

<body>
<!-- FIXED Preloader -->
<div class="loading" id="preloader">
  <i class="fas fa-spinner"></i>
  <span>Loading streets...</span>
</div>

<nav id="navbar">
  <a href="{{ url_for('index') }}" class="logo">ABTO</a>
  <div class="nav-links" id="navLinks">
    <a href="{{ url_for('index') }}" class="nav-link">Home</a>
    <a href="{{ url_for('upload') }}" class="nav-link">Upload</a>
    {% if current_user.is_authenticated %}
      <a href="{{ url_for('dashboard') }}" class="nav-link primary">
        <i class="fas fa-tachometer-alt"></i> Dashboard
      </a>
    {% else %}
      <a href="{{ url_for('login') }}" class="nav-link primary">
        <i class="fas fa-rocket"></i> Get Started
      </a>
    {% endif %}
  </div>
  <div class="mobile-menu-toggle" id="mobileToggle">
    <div class="hamburger"></div>
    <div class="hamburger"></div>
    <div class="hamburger"></div>
  </div>
</nav>

<main>
<!-- ENHANCED HERO WITH PERFECT 3 SCREENSHOT LAYOUT -->
<section class="hero">
  <!-- LEFT: Content -->
  <div class="hero-content">
    <div class="hero-badge fade-in-up" style="animation-delay:.3s">
      <i class="fas fa-globe-americas"></i>
      <span id="streetCount">{{ streets|length if streets else 0 }}+ Real Streets</span>
    </div>
    <h1 class="fade-in-up" style="animation-delay:.5s">
      Explore Real Streets<br>From Anywhere
    </h1>
    <p class="fade-in-up" style="animation-delay:.7s">
      Walk, drive or fly through real locations around the world. 
      No games. Just reality. Powered by real video footage.
    </p>
    <a href="#streets" class="hero-cta fade-in-up" style="animation-delay:.9s">
      <i class="fas fa-play-circle"></i>
      Start Exploring Now
    </a>
  </div>

  <!-- RIGHT: PERFECTED 3 Screenshot Layout - IMAGES READY! -->
  <div class="hero-visual">
    <h3 class="hero-visual-title fade-in-up" style="animation-delay:1.1s">
      Live Street Experience
    </h3>
    
    <div class="hero-screenshots">
      <!-- MAIN LARGE SCREENSHOT -->
      <div class="hero-screenshot-main fade-in-up" style="animation-delay:1.3s">
        <img src="{{ url_for('static', filename='img/main.png') }}" 
             alt="ABTO Main Street View" 
             loading="lazy">
      </div>
      
      <!-- TOP SMALL SCREENSHOT -->
      <div class="hero-screenshot-small-top fade-in-up" style="animation-delay:1.5s">
        <img src="{{ url_for('static', filename='img/top.png') }}" 
             alt="ABTO Top View" 
             loading="lazy">
      </div>
    </div>
    
    <!-- RIGHT SCREENSHOT -->
    <div class="hero-screenshot-small-right fade-in-up" style="animation-delay:1.7s">
      <img src="{{ url_for('static', filename='img/right.png') }}" 
           alt="ABTO Right View" 
           loading="lazy">
    </div>
  </div>
</section>

<!-- MODES SECTION -->
<section class="modes">
  <a href="{{ url_for('world_walk') }}" class="mode-card fade-in-up" style="animation-delay:2.1s">
    <div class="mode-icon">üö∂‚Äç‚ôÇÔ∏è</div>
    <h3>Walk Mode</h3>
    <p>Human-pace exploration with ambient realism</p>
  </a>
  <a href="{{ url_for('world_drive') }}" class="mode-card fade-in-up" style="animation-delay:2.3s">
    <div class="mode-icon">üöó</div>
    <h3>Drive Mode</h3>
    <p>Smooth highway and city driving experience</p>
  </a>
  <a href="{{ url_for('world_fly') }}" class="mode-card fade-in-up" style="animation-delay:2.5s">
    <div class="mode-icon">‚úàÔ∏è</div>
    <h3>Fly Mode</h3>
    <p>Aerial drone perspectives of cities</p>
  </a>
</section>

<!-- FEATURED STREETS -->
<section class="section" id="streets">
  <h2>Featured Streets</h2>
  <p>Handpicked immersive locations from around the world</p>

  {% if streets and streets|length > 0 %}
    <div class="grid" id="streetsGrid">
      {% for st in streets %}
        {% if st.videos and st.videos|length > 0 and st.videos[0].url %}
          {% set thumb_url = st.videos[0].url|replace('video/upload', 'video/upload/so_1,f_jpg,q_auto,w_400,c_fill,g_center') %}
        {% else %}
          {% set thumb_url = '/static/images/placeholder-street.jpg' %}
        {% endif %}
        <a href="{{ url_for('world', street_id=st._id) }}" class="card fade-in-up" style="animation-delay:{{ loop.index0 * 0.08 + 2.8 }}s">
          <div class="thumb" style="background-image:url('{{ thumb_url }}')">
            {% if thumb_url == '/static/images/placeholder-street.jpg' %}
              <div class="thumb-placeholder">
                <i class="fas fa-map-marked-alt"></i>
              </div>
            {% endif %}
          </div>
          <div class="card-body">
            <h4>{{ st.name[:45] }}{% if st.name|length > 45 %}...{% endif %}</h4>
            <span>
              <i class="fas fa-map-marker-alt" style="color:var(--accent);margin-right:6px"></i>
              {{ st.city or 'Unknown' }}, {{ st.country or 'Unknown' }}
            </span>
          </div>
        </a>
      {% endfor %}
    </div>
    {% if streets|length > 12 %}
      <div style="text-align:center; margin-top:60px">
        <a href="{{ url_for('dashboard') }}" class="hero-cta" style="font-size:18px; padding:18px 40px">
          <i class="fas fa-th-large"></i> View All Streets
        </a>
      </div>
    {% endif %}
  {% else %}
    <div class="empty-state">
      <i class="fas fa-map"></i>
      <h3>No streets available yet</h3>
      <p>Be the first to upload and explore real streets around the world.</p>
      <a href="{{ url_for('upload') }}" class="hero-cta" style="margin-top:40px; font-size:18px">
        <i class="fas fa-upload"></i> Upload First Street
      </a>
    </div>
  {% endif %}
</section>
</main>

<!-- FOOTER -->
<footer style="padding:60px max(32px, 6vw);text-align:center;color:var(--text-muted);border-top:1px solid var(--border);margin-top:100px">
  <p style="font-size:18px;margin-bottom:8px">
    &copy; 2025 <span style="font-weight:900;background:var(--gradient);-webkit-background-clip:text;-webkit-text-fill-color:transparent;letter-spacing:.8px;font-size:1.4em">ABTO</span>
  </p>
  <p style="font-size:14px;opacity:.8">
    A Better Travel Observer
  </p>
</footer>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // FIXED: Bulletproof preloader
  const preloader = document.getElementById('preloader');
  const hidePreloader = () => {
    preloader.style.opacity = '0';
    preloader.style.transform = 'scale(0.95)';
    setTimeout(() => { preloader.style.display = 'none'; }, 400);
  };
  
  const timeoutId = setTimeout(hidePreloader, 2200);
  const checkContent = () => {
    if (document.getElementById('streetsGrid') || document.querySelector('.hero')) {
      clearTimeout(timeoutId); hidePreloader();
    }
  };
  setTimeout(checkContent, 800);

  // Navbar scroll effect
  const navbar = document.getElementById('navbar');
  window.addEventListener('scroll', () => {
    navbar.classList.toggle('scrolled', window.scrollY > 50);
  });

  // Mobile menu toggle
  const mobileToggle = document.getElementById('mobileToggle');
  const navLinks = document.getElementById('navLinks');
  if (mobileToggle && navLinks) {
    mobileToggle.addEventListener('click', () => {
      navLinks.classList.toggle('active');
      mobileToggle.classList.toggle('open');
      document.body.style.overflow = navLinks.classList.contains('active') ? 'hidden' : '';
    });
    
    document.querySelectorAll('.nav-link').forEach(link => {
      link.addEventListener('click', () => {
        navLinks.classList.remove('active');
        mobileToggle.classList.remove('open');
        document.body.style.overflow = '';
      });
    });
  }

  // Smooth scroll CTA
  const heroCta = document.querySelector('.hero-cta[href="#streets"]');
  if (heroCta) {
    heroCta.addEventListener('click', (e) => {
      e.preventDefault();
      document.getElementById('streets').scrollIntoView({ 
        behavior: 'smooth', 
        block: 'start'
      });
    });
  }

  // Street count formatting
  const streetCount = document.getElementById('streetCount');
  if (streetCount) {
    const countMatch = streetCount.textContent.match(/(\d+)/);
    if (countMatch) {
      streetCount.textContent = parseInt(countMatch[1]).toLocaleString() + '+ Real Streets';
    }
  }

  // Scroll animations
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.style.opacity = '1';
        entry.target.style.transform = 'translateY(0)';
      }
    });
  }, {threshold: 0.1, rootMargin: '0px 0px -100px 0px'});

  document.querySelectorAll('.fade-in-up').forEach(el => {
    el.style.opacity = '0';
    el.style.transform = 'translateY(40px)';
    el.style.transition = 'all .7s cubic-bezier(0.4, 0, 0.2, 1)';
    observer.observe(el);
  });

  // Outside click closes mobile menu
  document.addEventListener('click', (e) => {
    if (!e.target.closest('nav') && navLinks?.classList.contains('active')) {
      navLinks.classList.remove('active');
      mobileToggle.classList.remove('open');
      document.body.style.overflow = '';
    }
  });
});
</script>

</body>
</html>
